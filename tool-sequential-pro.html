<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sequential Pro - 格式校正版</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f1f5f9; margin: 0; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #00b900; border-radius: 10px; }
        .chat-room-bg { background-color: #7988a0; background-image: radial-gradient(#cbd5e1 1px, transparent 1px); background-size: 20px 20px; }
        .control-panel { background: white; border-radius: 12px; padding: 16px; border: 1px solid #e2e8f0; }
        input[type="range"] { accent-color: #f59e0b; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;

        const SOCIAL_DATA = {
            NONE: { url: "https://vos.line-scdn.net/bot-designer-template-images/bot-designer-icon.png", label: "無" },
            FB: { url: "https://cdn-icons-png.flaticon.com/512/733/733547.png", label: "FB" },
            IG: { url: "https://cdn-icons-png.flaticon.com/512/2111/2111463.png", label: "IG" },
            TIKTOK: { url: "https://cdn-icons-png.flaticon.com/512/3046/3046121.png", label: "TikTok" },
            LINE: { url: "https://cdn-icons-png.flaticon.com/512/124/124027.png", label: "LINE" },
            PHONE: { url: "https://cdn-icons-png.flaticon.com/512/3616/3616215.png", label: "電話" },
            MAIL: { url: "https://cdn-icons-png.flaticon.com/512/732/732200.png", label: "郵件" },
            MAP: { url: "https://cdn-icons-png.flaticon.com/512/355/355980.png", label: "地標" }
        };

        const initialData = {
            size: "mega",
            media: { url: "https://aiwe.cc/wp-content/uploads/2025/12/f4545de10a478013942e50dd8c13282b-2.png", aspectRatio: "1:2", badgeText: "PREMIUM", badgeBg: "#D4AF37", badgeRadius: "xs", badgeTop: 20 },
            identity: { avatar: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=200", avatarTop: 60, name: "測試姓名", nameTop: 155, nameColor: "#000000", nameWeight: "bold", label1: "職稱標籤", label1Top: 190, label1Bg: "rgba(255,255,255,0.2)", label1Color: "#000000", label1Weight: "bold", desc: "這是一段說明文字。", descTop: 320, descColor: "#000000", descWeight: "regular", descAlign: "center" },
            social: { show: true, top: 230, icons: [{ type: "PHONE", uri: "tel:0900000000" }, { type: "LINE", uri: "https://line.me" }] },
            footer: { label: "聯繫我了解更多", uri: "https://line.me", footerBg: "#111111", themeColor: "#D4AF37", textColor: "#000000", weight: "bold" }
        };

        const App = () => {
            const [data, setData] = useState(initialData);

            const toPx = (v) => `${v}px`;

            const buildJson = useCallback(() => {
                const bubble = {
                    type: "bubble",
                    size: data.size,
                    body: {
                        type: "box", layout: "vertical", paddingAll: "0px",
                        contents: [
                            { type: "image", url: data.media.url, size: "full", aspectRatio: data.media.aspectRatio, aspectMode: "cover" },
                            { type: "box", layout: "vertical", position: "absolute", offsetTop: toPx(data.media.badgeTop), offsetEnd: "20px", backgroundColor: data.media.badgeBg, cornerRadius: data.media.badgeRadius, paddingAll: "2px", paddingStart: "8px", paddingEnd: "8px", contents: [{ type: "text", text: data.media.badgeText, color: "#ffffff", size: "xxs", weight: "bold" }] },
                            { type: "box", layout: "vertical", position: "absolute", offsetTop: toPx(data.identity.avatarTop), offsetStart: "0px", offsetEnd: "0px", alignItems: "center", contents: [{ type: "box", layout: "vertical", width: "85px", height: "85px", cornerRadius: "100px", borderWidth: "3px", borderColor: "#ffffff", contents: [{ type: "image", url: data.identity.avatar, size: "full", aspectMode: "cover" }] }] },
                            { type: "box", layout: "vertical", position: "absolute", offsetTop: toPx(data.identity.nameTop), offsetStart: "0px", offsetEnd: "0px", contents: [{ type: "text", text: data.identity.name, weight: data.identity.nameWeight, size: "xxl", color: data.identity.nameColor, align: "center" }] },
                            { type: "box", layout: "vertical", position: "absolute", offsetTop: toPx(data.identity.label1Top), offsetStart: "40px", offsetEnd: "40px", backgroundColor: data.identity.label1Bg, cornerRadius: "md", paddingAll: "4px", contents: [{ type: "text", text: data.identity.label1, size: "xs", color: data.identity.label1Color, align: "center", weight: data.identity.label1Weight }] }
                        ]
                    },
                    footer: { type: "box", layout: "vertical", paddingAll: "15px", backgroundColor: data.footer.footerBg, contents: [{ type: "box", layout: "vertical", backgroundColor: data.footer.themeColor, paddingAll: "12px", cornerRadius: "md", action: { type: "uri", uri: data.footer.uri || "https://line.me" }, contents: [{ type: "text", text: data.footer.label, color: data.footer.textColor, align: "center", weight: data.footer.weight, size: "sm" }] }] }
                };

                if (data.social.show) {
                    bubble.body.contents.push({ type: "box", layout: "horizontal", position: "absolute", offsetTop: toPx(data.social.top), offsetStart: "0px", offsetEnd: "0px", justifyContent: "center", spacing: "md", contents: data.social.icons.map(icon => ({ type: "box", layout: "vertical", width: "32px", height: "32px", cornerRadius: "100px", backgroundColor: "rgba(255,255,255,0.1)", paddingAll: "7px", action: { type: "uri", uri: icon.uri || "https://line.me" }, contents: [{ type: "image", url: SOCIAL_DATA[icon.type]?.url, size: "full" }] })) });
                }

                bubble.body.contents.push({ type: "box", layout: "vertical", position: "absolute", offsetTop: toPx(data.identity.descTop), offsetStart: "30px", offsetEnd: "30px", contents: [{ type: "text", text: data.identity.desc, wrap: true, size: "sm", color: data.identity.descColor, align: data.identity.descAlign, lineHeight: "1.6", weight: data.identity.descWeight }] });
                return bubble;
            }, [data]);

            useEffect(() => { window.parent.postMessage({ type: 'CHILD_READY' }, '*'); }, []);
            useEffect(() => {
                const jsonStr = JSON.stringify(buildJson());
                window.parent.postMessage({ type: 'SYNC_FLEX_DATA', json: jsonStr }, '*');
            }, [data, buildJson]);

            const updateField = (path, val) => {
                const keys = path.split('.');
                setData(prev => {
                    const next = JSON.parse(JSON.stringify(prev));
                    let curr = next;
                    for (let i = 0; i < keys.length - 1; i++) curr = curr[keys[i]];
                    curr[keys[keys.length - 1]] = val;
                    return next;
                });
            };

            const handleMasterMove = (newVal) => {
                const diff = newVal - data.identity.avatarTop;
                setData(prev => ({
                    ...prev,
                    identity: { ...prev.identity, avatarTop: newVal, nameTop: prev.identity.nameTop + diff, label1Top: prev.identity.label1Top + diff, descTop: prev.identity.descTop + diff },
                    social: { ...prev.social, top: prev.social.top + diff }
                }));
            };

            return (
                <div className="flex h-screen bg-slate-100 overflow-hidden font-bold text-black">
                    <div className="w-1/2 bg-white border-r flex flex-col shadow-2xl z-20">
                        <div className="p-6 border-b"><h1 className="text-xl font-black">業務版編輯器 (格式修正)</h1></div>
                        <div className="flex-1 overflow-y-auto p-6 space-y-6 custom-scrollbar text-black">
                            <div className="control-panel space-y-4">
                                <h3 className="text-sm text-slate-400">1. 背景連動調整 (Master)</h3>
                                <div className="flex items-center gap-4"><input type="range" min="0" max="600" value={data.identity.avatarTop} onChange={e=>handleMasterMove(parseInt(e.target.value))} className="flex-1" /><span>{data.identity.avatarTop}</span></div>
                            </div>
                            <div className="control-panel space-y-4">
                                <h3 className="text-sm text-slate-400">2. 文字編輯 (預設黑色)</h3>
                                <input type="text" value={data.identity.name} onChange={e=>updateField('identity.name', e.target.value)} className="w-full p-2 border rounded" placeholder="姓名" />
                                <div className="flex gap-2">
                                    <input type="color" value={data.identity.nameColor} onChange={e=>updateField('identity.nameColor', e.target.value)} className="w-10 h-10" />
                                    <select value={data.identity.nameWeight} onChange={e=>updateField('identity.nameWeight', e.target.value)} className="flex-1 border rounded"><option value="bold">粗體</option><option value="regular">一般</option></select>
                                </div>
                                <textarea value={data.identity.desc} onChange={e=>updateField('identity.desc', e.target.value)} className="w-full p-2 border rounded h-20" placeholder="說明"></textarea>
                                <div className="flex bg-slate-100 p-1 rounded gap-1">
                                    {['start', 'center', 'end'].map(a => <button key={a} onClick={()=>updateField('identity.descAlign', a)} className={`flex-1 text-xs py-1 rounded ${data.identity.descAlign === a ? 'bg-white shadow' : ''}`}>{a}</button>)}
                                </div>
                            </div>
                            <div className="control-panel space-y-4">
                                <h3 className="text-sm text-slate-400">3. 社群連結 (含 TikTok)</h3>
                                {data.social.icons.map((s, i) => (
                                    <div key={i} className="flex gap-2">
                                        <select value={s.type} onChange={e=>{const nl=[...data.social.icons]; nl[i].type=e.target.value; updateField('social.icons', nl)}} className="border rounded text-xs w-24">
                                            {Object.keys(SOCIAL_DATA).map(k=><option key={k} value={k}>{SOCIAL_DATA[k].label}</option>)}
                                        </select>
                                        <input type="text" value={s.uri} onChange={e=>{const nl=[...data.social.icons]; nl[i].uri=e.target.value; updateField('social.icons', nl)}} className="flex-1 p-1 border rounded text-xs" />
                                    </div>
                                ))}
                            </div>
                            <div className="control-panel space-y-4 mb-10">
                                <h3 className="text-sm text-slate-400">4. 底部 Footer</h3>
                                <div className="grid grid-cols-2 gap-2">
                                    <div className="flex flex-col"><label className="text-[10px]">Footer 背景</label><input type="color" value={data.footer.footerBg} onChange={e=>updateField('footer.footerBg', e.target.value)} className="w-full h-8" /></div>
                                    <div className="flex flex-col"><label className="text-[10px]">按鈕背景</label><input type="color" value={data.footer.themeColor} onChange={e=>updateField('footer.themeColor', e.target.value)} className="w-full h-8" /></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div className="flex-1 flex flex-col chat-room-bg overflow-y-auto">
                        <div className="p-10 flex justify-center">
                            <div className="rounded-3xl shadow-2xl overflow-hidden relative" style={{ width: '300px', backgroundColor: data.footer.footerBg }}>
                                <div className="relative" style={{ height: '600px' }}>
                                    <img src={data.media.url} className="w-full h-full object-cover" />
                                    <div className="absolute w-full flex justify-center" style={{ top: toPx(data.identity.avatarTop) }}><img src={data.identity.avatar} className="w-20 h-20 rounded-full border-4 border-white shadow-xl" /></div>
                                    <div className="absolute w-full text-center px-4" style={{ top: toPx(data.identity.nameTop), color: data.identity.nameColor, fontWeight: data.identity.nameWeight==='bold'?900:400, fontSize: '20px' }}>{data.identity.name}</div>
                                    <div className="absolute w-full px-8" style={{ top: toPx(data.identity.descTop), color: data.identity.descColor, textAlign: data.identity.descAlign==='start'?'left':data.identity.descAlign==='end'?'right':'center', fontSize: '12px' }}>{data.identity.desc}</div>
                                </div>
                                <div className="p-4" style={{ backgroundColor: data.footer.footerBg }}><div className="py-3 text-center rounded-xl text-sm" style={{ backgroundColor: data.footer.themeColor, color: data.footer.textColor }}>{data.footer.label}</div></div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html><!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sequential Pro - 格式校正版</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f1f5f9; margin: 0; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #00b900; border-radius: 10px; }
        .chat-room-bg { background-color: #7988a0; background-image: radial-gradient(#cbd5e1 1px, transparent 1px); background-size: 20px 20px; }
        .control-panel { background: white; border-radius: 12px; padding: 16px; border: 1px solid #e2e8f0; }
        input[type="range"] { accent-color: #f59e0b; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;

        const SOCIAL_DATA = {
            NONE: { url: "https://vos.line-scdn.net/bot-designer-template-images/bot-designer-icon.png", label: "無" },
            FB: { url: "https://cdn-icons-png.flaticon.com/512/733/733547.png", label: "FB" },
            IG: { url: "https://cdn-icons-png.flaticon.com/512/2111/2111463.png", label: "IG" },
            TIKTOK: { url: "https://cdn-icons-png.flaticon.com/512/3046/3046121.png", label: "TikTok" },
            LINE: { url: "https://cdn-icons-png.flaticon.com/512/124/124027.png", label: "LINE" },
            PHONE: { url: "https://cdn-icons-png.flaticon.com/512/3616/3616215.png", label: "電話" },
            MAIL: { url: "https://cdn-icons-png.flaticon.com/512/732/732200.png", label: "郵件" },
            MAP: { url: "https://cdn-icons-png.flaticon.com/512/355/355980.png", label: "地標" }
        };

        const initialData = {
            size: "mega",
            media: { url: "https://aiwe.cc/wp-content/uploads/2025/12/f4545de10a478013942e50dd8c13282b-2.png", aspectRatio: "1:2", badgeText: "PREMIUM", badgeBg: "#D4AF37", badgeRadius: "xs", badgeTop: 20 },
            identity: { avatar: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=200", avatarTop: 60, name: "測試姓名", nameTop: 155, nameColor: "#000000", nameWeight: "bold", label1: "職稱標籤", label1Top: 190, label1Bg: "rgba(255,255,255,0.2)", label1Color: "#000000", label1Weight: "bold", desc: "這是一段說明文字。", descTop: 320, descColor: "#000000", descWeight: "regular", descAlign: "center" },
            social: { show: true, top: 230, icons: [{ type: "PHONE", uri: "tel:0900000000" }, { type: "LINE", uri: "https://line.me" }] },
            footer: { label: "聯繫我了解更多", uri: "https://line.me", footerBg: "#111111", themeColor: "#D4AF37", textColor: "#000000", weight: "bold" }
        };

        const App = () => {
            const [data, setData] = useState(initialData);

            const toPx = (v) => `${v}px`;

            const buildJson = useCallback(() => {
                const bubble = {
                    type: "bubble",
                    size: data.size,
                    body: {
                        type: "box", layout: "vertical", paddingAll: "0px",
                        contents: [
                            { type: "image", url: data.media.url, size: "full", aspectRatio: data.media.aspectRatio, aspectMode: "cover" },
                            { type: "box", layout: "vertical", position: "absolute", offsetTop: toPx(data.media.badgeTop), offsetEnd: "20px", backgroundColor: data.media.badgeBg, cornerRadius: data.media.badgeRadius, paddingAll: "2px", paddingStart: "8px", paddingEnd: "8px", contents: [{ type: "text", text: data.media.badgeText, color: "#ffffff", size: "xxs", weight: "bold" }] },
                            { type: "box", layout: "vertical", position: "absolute", offsetTop: toPx(data.identity.avatarTop), offsetStart: "0px", offsetEnd: "0px", alignItems: "center", contents: [{ type: "box", layout: "vertical", width: "85px", height: "85px", cornerRadius: "100px", borderWidth: "3px", borderColor: "#ffffff", contents: [{ type: "image", url: data.identity.avatar, size: "full", aspectMode: "cover" }] }] },
                            { type: "box", layout: "vertical", position: "absolute", offsetTop: toPx(data.identity.nameTop), offsetStart: "0px", offsetEnd: "0px", contents: [{ type: "text", text: data.identity.name, weight: data.identity.nameWeight, size: "xxl", color: data.identity.nameColor, align: "center" }] },
                            { type: "box", layout: "vertical", position: "absolute", offsetTop: toPx(data.identity.label1Top), offsetStart: "40px", offsetEnd: "40px", backgroundColor: data.identity.label1Bg, cornerRadius: "md", paddingAll: "4px", contents: [{ type: "text", text: data.identity.label1, size: "xs", color: data.identity.label1Color, align: "center", weight: data.identity.label1Weight }] }
                        ]
                    },
                    footer: { type: "box", layout: "vertical", paddingAll: "15px", backgroundColor: data.footer.footerBg, contents: [{ type: "box", layout: "vertical", backgroundColor: data.footer.themeColor, paddingAll: "12px", cornerRadius: "md", action: { type: "uri", uri: data.footer.uri || "https://line.me" }, contents: [{ type: "text", text: data.footer.label, color: data.footer.textColor, align: "center", weight: data.footer.weight, size: "sm" }] }] }
                };

                if (data.social.show) {
                    bubble.body.contents.push({ type: "box", layout: "horizontal", position: "absolute", offsetTop: toPx(data.social.top), offsetStart: "0px", offsetEnd: "0px", justifyContent: "center", spacing: "md", contents: data.social.icons.map(icon => ({ type: "box", layout: "vertical", width: "32px", height: "32px", cornerRadius: "100px", backgroundColor: "rgba(255,255,255,0.1)", paddingAll: "7px", action: { type: "uri", uri: icon.uri || "https://line.me" }, contents: [{ type: "image", url: SOCIAL_DATA[icon.type]?.url, size: "full" }] })) });
                }

                bubble.body.contents.push({ type: "box", layout: "vertical", position: "absolute", offsetTop: toPx(data.identity.descTop), offsetStart: "30px", offsetEnd: "30px", contents: [{ type: "text", text: data.identity.desc, wrap: true, size: "sm", color: data.identity.descColor, align: data.identity.descAlign, lineHeight: "1.6", weight: data.identity.descWeight }] });
                return bubble;
            }, [data]);

            useEffect(() => { window.parent.postMessage({ type: 'CHILD_READY' }, '*'); }, []);
            useEffect(() => {
                const jsonStr = JSON.stringify(buildJson());
                window.parent.postMessage({ type: 'SYNC_FLEX_DATA', json: jsonStr }, '*');
            }, [data, buildJson]);

            const updateField = (path, val) => {
                const keys = path.split('.');
                setData(prev => {
                    const next = JSON.parse(JSON.stringify(prev));
                    let curr = next;
                    for (let i = 0; i < keys.length - 1; i++) curr = curr[keys[i]];
                    curr[keys[keys.length - 1]] = val;
                    return next;
                });
            };

            const handleMasterMove = (newVal) => {
                const diff = newVal - data.identity.avatarTop;
                setData(prev => ({
                    ...prev,
                    identity: { ...prev.identity, avatarTop: newVal, nameTop: prev.identity.nameTop + diff, label1Top: prev.identity.label1Top + diff, descTop: prev.identity.descTop + diff },
                    social: { ...prev.social, top: prev.social.top + diff }
                }));
            };

            return (
                <div className="flex h-screen bg-slate-100 overflow-hidden font-bold text-black">
                    <div className="w-1/2 bg-white border-r flex flex-col shadow-2xl z-20">
                        <div className="p-6 border-b"><h1 className="text-xl font-black">業務版編輯器 (格式修正)</h1></div>
                        <div className="flex-1 overflow-y-auto p-6 space-y-6 custom-scrollbar text-black">
                            <div className="control-panel space-y-4">
                                <h3 className="text-sm text-slate-400">1. 背景連動調整 (Master)</h3>
                                <div className="flex items-center gap-4"><input type="range" min="0" max="600" value={data.identity.avatarTop} onChange={e=>handleMasterMove(parseInt(e.target.value))} className="flex-1" /><span>{data.identity.avatarTop}</span></div>
                            </div>
                            <div className="control-panel space-y-4">
                                <h3 className="text-sm text-slate-400">2. 文字編輯 (預設黑色)</h3>
                                <input type="text" value={data.identity.name} onChange={e=>updateField('identity.name', e.target.value)} className="w-full p-2 border rounded" placeholder="姓名" />
                                <div className="flex gap-2">
                                    <input type="color" value={data.identity.nameColor} onChange={e=>updateField('identity.nameColor', e.target.value)} className="w-10 h-10" />
                                    <select value={data.identity.nameWeight} onChange={e=>updateField('identity.nameWeight', e.target.value)} className="flex-1 border rounded"><option value="bold">粗體</option><option value="regular">一般</option></select>
                                </div>
                                <textarea value={data.identity.desc} onChange={e=>updateField('identity.desc', e.target.value)} className="w-full p-2 border rounded h-20" placeholder="說明"></textarea>
                                <div className="flex bg-slate-100 p-1 rounded gap-1">
                                    {['start', 'center', 'end'].map(a => <button key={a} onClick={()=>updateField('identity.descAlign', a)} className={`flex-1 text-xs py-1 rounded ${data.identity.descAlign === a ? 'bg-white shadow' : ''}`}>{a}</button>)}
                                </div>
                            </div>
                            <div className="control-panel space-y-4">
                                <h3 className="text-sm text-slate-400">3. 社群連結 (含 TikTok)</h3>
                                {data.social.icons.map((s, i) => (
                                    <div key={i} className="flex gap-2">
                                        <select value={s.type} onChange={e=>{const nl=[...data.social.icons]; nl[i].type=e.target.value; updateField('social.icons', nl)}} className="border rounded text-xs w-24">
                                            {Object.keys(SOCIAL_DATA).map(k=><option key={k} value={k}>{SOCIAL_DATA[k].label}</option>)}
                                        </select>
                                        <input type="text" value={s.uri} onChange={e=>{const nl=[...data.social.icons]; nl[i].uri=e.target.value; updateField('social.icons', nl)}} className="flex-1 p-1 border rounded text-xs" />
                                    </div>
                                ))}
                            </div>
                            <div className="control-panel space-y-4 mb-10">
                                <h3 className="text-sm text-slate-400">4. 底部 Footer</h3>
                                <div className="grid grid-cols-2 gap-2">
                                    <div className="flex flex-col"><label className="text-[10px]">Footer 背景</label><input type="color" value={data.footer.footerBg} onChange={e=>updateField('footer.footerBg', e.target.value)} className="w-full h-8" /></div>
                                    <div className="flex flex-col"><label className="text-[10px]">按鈕背景</label><input type="color" value={data.footer.themeColor} onChange={e=>updateField('footer.themeColor', e.target.value)} className="w-full h-8" /></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div className="flex-1 flex flex-col chat-room-bg overflow-y-auto">
                        <div className="p-10 flex justify-center">
                            <div className="rounded-3xl shadow-2xl overflow-hidden relative" style={{ width: '300px', backgroundColor: data.footer.footerBg }}>
                                <div className="relative" style={{ height: '600px' }}>
                                    <img src={data.media.url} className="w-full h-full object-cover" />
                                    <div className="absolute w-full flex justify-center" style={{ top: toPx(data.identity.avatarTop) }}><img src={data.identity.avatar} className="w-20 h-20 rounded-full border-4 border-white shadow-xl" /></div>
                                    <div className="absolute w-full text-center px-4" style={{ top: toPx(data.identity.nameTop), color: data.identity.nameColor, fontWeight: data.identity.nameWeight==='bold'?900:400, fontSize: '20px' }}>{data.identity.name}</div>
                                    <div className="absolute w-full px-8" style={{ top: toPx(data.identity.descTop), color: data.identity.descColor, textAlign: data.identity.descAlign==='start'?'left':data.identity.descAlign==='end'?'right':'center', fontSize: '12px' }}>{data.identity.desc}</div>
                                </div>
                                <div className="p-4" style={{ backgroundColor: data.footer.footerBg }}><div className="py-3 text-center rounded-xl text-sm" style={{ backgroundColor: data.footer.themeColor, color: data.footer.textColor }}>{data.footer.label}</div></div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html><!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sequential Pro - 格式校正版</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f1f5f9; margin: 0; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #00b900; border-radius: 10px; }
        .chat-room-bg { background-color: #7988a0; background-image: radial-gradient(#cbd5e1 1px, transparent 1px); background-size: 20px 20px; }
        .control-panel { background: white; border-radius: 12px; padding: 16px; border: 1px solid #e2e8f0; }
        input[type="range"] { accent-color: #f59e0b; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;

        const SOCIAL_DATA = {
            NONE: { url: "https://vos.line-scdn.net/bot-designer-template-images/bot-designer-icon.png", label: "無" },
            FB: { url: "https://cdn-icons-png.flaticon.com/512/733/733547.png", label: "FB" },
            IG: { url: "https://cdn-icons-png.flaticon.com/512/2111/2111463.png", label: "IG" },
            TIKTOK: { url: "https://cdn-icons-png.flaticon.com/512/3046/3046121.png", label: "TikTok" },
            LINE: { url: "https://cdn-icons-png.flaticon.com/512/124/124027.png", label: "LINE" },
            PHONE: { url: "https://cdn-icons-png.flaticon.com/512/3616/3616215.png", label: "電話" },
            MAIL: { url: "https://cdn-icons-png.flaticon.com/512/732/732200.png", label: "郵件" },
            MAP: { url: "https://cdn-icons-png.flaticon.com/512/355/355980.png", label: "地標" }
        };

        const initialData = {
            size: "mega",
            media: { url: "https://aiwe.cc/wp-content/uploads/2025/12/f4545de10a478013942e50dd8c13282b-2.png", aspectRatio: "1:2", badgeText: "PREMIUM", badgeBg: "#D4AF37", badgeRadius: "xs", badgeTop: 20 },
            identity: { avatar: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=200", avatarTop: 60, name: "測試姓名", nameTop: 155, nameColor: "#000000", nameWeight: "bold", label1: "職稱標籤", label1Top: 190, label1Bg: "rgba(255,255,255,0.2)", label1Color: "#000000", label1Weight: "bold", desc: "這是一段說明文字。", descTop: 320, descColor: "#000000", descWeight: "regular", descAlign: "center" },
            social: { show: true, top: 230, icons: [{ type: "PHONE", uri: "tel:0900000000" }, { type: "LINE", uri: "https://line.me" }] },
            footer: { label: "聯繫我了解更多", uri: "https://line.me", footerBg: "#111111", themeColor: "#D4AF37", textColor: "#000000", weight: "bold" }
        };

        const App = () => {
            const [data, setData] = useState(initialData);

            const toPx = (v) => `${v}px`;

            const buildJson = useCallback(() => {
                const bubble = {
                    type: "bubble",
                    size: data.size,
                    body: {
                        type: "box", layout: "vertical", paddingAll: "0px",
                        contents: [
                            { type: "image", url: data.media.url, size: "full", aspectRatio: data.media.aspectRatio, aspectMode: "cover" },
                            { type: "box", layout: "vertical", position: "absolute", offsetTop: toPx(data.media.badgeTop), offsetEnd: "20px", backgroundColor: data.media.badgeBg, cornerRadius: data.media.badgeRadius, paddingAll: "2px", paddingStart: "8px", paddingEnd: "8px", contents: [{ type: "text", text: data.media.badgeText, color: "#ffffff", size: "xxs", weight: "bold" }] },
                            { type: "box", layout: "vertical", position: "absolute", offsetTop: toPx(data.identity.avatarTop), offsetStart: "0px", offsetEnd: "0px", alignItems: "center", contents: [{ type: "box", layout: "vertical", width: "85px", height: "85px", cornerRadius: "100px", borderWidth: "3px", borderColor: "#ffffff", contents: [{ type: "image", url: data.identity.avatar, size: "full", aspectMode: "cover" }] }] },
                            { type: "box", layout: "vertical", position: "absolute", offsetTop: toPx(data.identity.nameTop), offsetStart: "0px", offsetEnd: "0px", contents: [{ type: "text", text: data.identity.name, weight: data.identity.nameWeight, size: "xxl", color: data.identity.nameColor, align: "center" }] },
                            { type: "box", layout: "vertical", position: "absolute", offsetTop: toPx(data.identity.label1Top), offsetStart: "40px", offsetEnd: "40px", backgroundColor: data.identity.label1Bg, cornerRadius: "md", paddingAll: "4px", contents: [{ type: "text", text: data.identity.label1, size: "xs", color: data.identity.label1Color, align: "center", weight: data.identity.label1Weight }] }
                        ]
                    },
                    footer: { type: "box", layout: "vertical", paddingAll: "15px", backgroundColor: data.footer.footerBg, contents: [{ type: "box", layout: "vertical", backgroundColor: data.footer.themeColor, paddingAll: "12px", cornerRadius: "md", action: { type: "uri", uri: data.footer.uri || "https://line.me" }, contents: [{ type: "text", text: data.footer.label, color: data.footer.textColor, align: "center", weight: data.footer.weight, size: "sm" }] }] }
                };

                if (data.social.show) {
                    bubble.body.contents.push({ type: "box", layout: "horizontal", position: "absolute", offsetTop: toPx(data.social.top), offsetStart: "0px", offsetEnd: "0px", justifyContent: "center", spacing: "md", contents: data.social.icons.map(icon => ({ type: "box", layout: "vertical", width: "32px", height: "32px", cornerRadius: "100px", backgroundColor: "rgba(255,255,255,0.1)", paddingAll: "7px", action: { type: "uri", uri: icon.uri || "https://line.me" }, contents: [{ type: "image", url: SOCIAL_DATA[icon.type]?.url, size: "full" }] })) });
                }

                bubble.body.contents.push({ type: "box", layout: "vertical", position: "absolute", offsetTop: toPx(data.identity.descTop), offsetStart: "30px", offsetEnd: "30px", contents: [{ type: "text", text: data.identity.desc, wrap: true, size: "sm", color: data.identity.descColor, align: data.identity.descAlign, lineHeight: "1.6", weight: data.identity.descWeight }] });
                return bubble;
            }, [data]);

            useEffect(() => { window.parent.postMessage({ type: 'CHILD_READY' }, '*'); }, []);
            useEffect(() => {
                const jsonStr = JSON.stringify(buildJson());
                window.parent.postMessage({ type: 'SYNC_FLEX_DATA', json: jsonStr }, '*');
            }, [data, buildJson]);

            const updateField = (path, val) => {
                const keys = path.split('.');
                setData(prev => {
                    const next = JSON.parse(JSON.stringify(prev));
                    let curr = next;
                    for (let i = 0; i < keys.length - 1; i++) curr = curr[keys[i]];
                    curr[keys[keys.length - 1]] = val;
                    return next;
                });
            };

            const handleMasterMove = (newVal) => {
                const diff = newVal - data.identity.avatarTop;
                setData(prev => ({
                    ...prev,
                    identity: { ...prev.identity, avatarTop: newVal, nameTop: prev.identity.nameTop + diff, label1Top: prev.identity.label1Top + diff, descTop: prev.identity.descTop + diff },
                    social: { ...prev.social, top: prev.social.top + diff }
                }));
            };

            return (
                <div className="flex h-screen bg-slate-100 overflow-hidden font-bold text-black">
                    <div className="w-1/2 bg-white border-r flex flex-col shadow-2xl z-20">
                        <div className="p-6 border-b"><h1 className="text-xl font-black">業務版編輯器 (格式修正)</h1></div>
                        <div className="flex-1 overflow-y-auto p-6 space-y-6 custom-scrollbar text-black">
                            <div className="control-panel space-y-4">
                                <h3 className="text-sm text-slate-400">1. 背景連動調整 (Master)</h3>
                                <div className="flex items-center gap-4"><input type="range" min="0" max="600" value={data.identity.avatarTop} onChange={e=>handleMasterMove(parseInt(e.target.value))} className="flex-1" /><span>{data.identity.avatarTop}</span></div>
                            </div>
                            <div className="control-panel space-y-4">
                                <h3 className="text-sm text-slate-400">2. 文字編輯 (預設黑色)</h3>
                                <input type="text" value={data.identity.name} onChange={e=>updateField('identity.name', e.target.value)} className="w-full p-2 border rounded" placeholder="姓名" />
                                <div className="flex gap-2">
                                    <input type="color" value={data.identity.nameColor} onChange={e=>updateField('identity.nameColor', e.target.value)} className="w-10 h-10" />
                                    <select value={data.identity.nameWeight} onChange={e=>updateField('identity.nameWeight', e.target.value)} className="flex-1 border rounded"><option value="bold">粗體</option><option value="regular">一般</option></select>
                                </div>
                                <textarea value={data.identity.desc} onChange={e=>updateField('identity.desc', e.target.value)} className="w-full p-2 border rounded h-20" placeholder="說明"></textarea>
                                <div className="flex bg-slate-100 p-1 rounded gap-1">
                                    {['start', 'center', 'end'].map(a => <button key={a} onClick={()=>updateField('identity.descAlign', a)} className={`flex-1 text-xs py-1 rounded ${data.identity.descAlign === a ? 'bg-white shadow' : ''}`}>{a}</button>)}
                                </div>
                            </div>
                            <div className="control-panel space-y-4">
                                <h3 className="text-sm text-slate-400">3. 社群連結 (含 TikTok)</h3>
                                {data.social.icons.map((s, i) => (
                                    <div key={i} className="flex gap-2">
                                        <select value={s.type} onChange={e=>{const nl=[...data.social.icons]; nl[i].type=e.target.value; updateField('social.icons', nl)}} className="border rounded text-xs w-24">
                                            {Object.keys(SOCIAL_DATA).map(k=><option key={k} value={k}>{SOCIAL_DATA[k].label}</option>)}
                                        </select>
                                        <input type="text" value={s.uri} onChange={e=>{const nl=[...data.social.icons]; nl[i].uri=e.target.value; updateField('social.icons', nl)}} className="flex-1 p-1 border rounded text-xs" />
                                    </div>
                                ))}
                            </div>
                            <div className="control-panel space-y-4 mb-10">
                                <h3 className="text-sm text-slate-400">4. 底部 Footer</h3>
                                <div className="grid grid-cols-2 gap-2">
                                    <div className="flex flex-col"><label className="text-[10px]">Footer 背景</label><input type="color" value={data.footer.footerBg} onChange={e=>updateField('footer.footerBg', e.target.value)} className="w-full h-8" /></div>
                                    <div className="flex flex-col"><label className="text-[10px]">按鈕背景</label><input type="color" value={data.footer.themeColor} onChange={e=>updateField('footer.themeColor', e.target.value)} className="w-full h-8" /></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div className="flex-1 flex flex-col chat-room-bg overflow-y-auto">
                        <div className="p-10 flex justify-center">
                            <div className="rounded-3xl shadow-2xl overflow-hidden relative" style={{ width: '300px', backgroundColor: data.footer.footerBg }}>
                                <div className="relative" style={{ height: '600px' }}>
                                    <img src={data.media.url} className="w-full h-full object-cover" />
                                    <div className="absolute w-full flex justify-center" style={{ top: toPx(data.identity.avatarTop) }}><img src={data.identity.avatar} className="w-20 h-20 rounded-full border-4 border-white shadow-xl" /></div>
                                    <div className="absolute w-full text-center px-4" style={{ top: toPx(data.identity.nameTop), color: data.identity.nameColor, fontWeight: data.identity.nameWeight==='bold'?900:400, fontSize: '20px' }}>{data.identity.name}</div>
                                    <div className="absolute w-full px-8" style={{ top: toPx(data.identity.descTop), color: data.identity.descColor, textAlign: data.identity.descAlign==='start'?'left':data.identity.descAlign==='end'?'right':'center', fontSize: '12px' }}>{data.identity.desc}</div>
                                </div>
                                <div className="p-4" style={{ backgroundColor: data.footer.footerBg }}><div className="py-3 text-center rounded-xl text-sm" style={{ backgroundColor: data.footer.themeColor, color: data.footer.textColor }}>{data.footer.label}</div></div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html><!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sequential Pro - 格式校正版</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f1f5f9; margin: 0; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #00b900; border-radius: 10px; }
        .chat-room-bg { background-color: #7988a0; background-image: radial-gradient(#cbd5e1 1px, transparent 1px); background-size: 20px 20px; }
        .control-panel { background: white; border-radius: 12px; padding: 16px; border: 1px solid #e2e8f0; }
        input[type="range"] { accent-color: #f59e0b; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;

        const SOCIAL_DATA = {
            NONE: { url: "https://vos.line-scdn.net/bot-designer-template-images/bot-designer-icon.png", label: "無" },
            FB: { url: "https://cdn-icons-png.flaticon.com/512/733/733547.png", label: "FB" },
            IG: { url: "https://cdn-icons-png.flaticon.com/512/2111/2111463.png", label: "IG" },
            TIKTOK: { url: "https://cdn-icons-png.flaticon.com/512/3046/3046121.png", label: "TikTok" },
            LINE: { url: "https://cdn-icons-png.flaticon.com/512/124/124027.png", label: "LINE" },
            PHONE: { url: "https://cdn-icons-png.flaticon.com/512/3616/3616215.png", label: "電話" },
            MAIL: { url: "https://cdn-icons-png.flaticon.com/512/732/732200.png", label: "郵件" },
            MAP: { url: "https://cdn-icons-png.flaticon.com/512/355/355980.png", label: "地標" }
        };

        const initialData = {
            size: "mega",
            media: { url: "https://aiwe.cc/wp-content/uploads/2025/12/f4545de10a478013942e50dd8c13282b-2.png", aspectRatio: "1:2", badgeText: "PREMIUM", badgeBg: "#D4AF37", badgeRadius: "xs", badgeTop: 20 },
            identity: { avatar: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=200", avatarTop: 60, name: "測試姓名", nameTop: 155, nameColor: "#000000", nameWeight: "bold", label1: "職稱標籤", label1Top: 190, label1Bg: "rgba(255,255,255,0.2)", label1Color: "#000000", label1Weight: "bold", desc: "這是一段說明文字。", descTop: 320, descColor: "#000000", descWeight: "regular", descAlign: "center" },
            social: { show: true, top: 230, icons: [{ type: "PHONE", uri: "tel:0900000000" }, { type: "LINE", uri: "https://line.me" }] },
            footer: { label: "聯繫我了解更多", uri: "https://line.me", footerBg: "#111111", themeColor: "#D4AF37", textColor: "#000000", weight: "bold" }
        };

        const App = () => {
            const [data, setData] = useState(initialData);

            const toPx = (v) => `${v}px`;

            const buildJson = useCallback(() => {
                const bubble = {
                    type: "bubble",
                    size: data.size,
                    body: {
                        type: "box", layout: "vertical", paddingAll: "0px",
                        contents: [
                            { type: "image", url: data.media.url, size: "full", aspectRatio: data.media.aspectRatio, aspectMode: "cover" },
                            { type: "box", layout: "vertical", position: "absolute", offsetTop: toPx(data.media.badgeTop), offsetEnd: "20px", backgroundColor: data.media.badgeBg, cornerRadius: data.media.badgeRadius, paddingAll: "2px", paddingStart: "8px", paddingEnd: "8px", contents: [{ type: "text", text: data.media.badgeText, color: "#ffffff", size: "xxs", weight: "bold" }] },
                            { type: "box", layout: "vertical", position: "absolute", offsetTop: toPx(data.identity.avatarTop), offsetStart: "0px", offsetEnd: "0px", alignItems: "center", contents: [{ type: "box", layout: "vertical", width: "85px", height: "85px", cornerRadius: "100px", borderWidth: "3px", borderColor: "#ffffff", contents: [{ type: "image", url: data.identity.avatar, size: "full", aspectMode: "cover" }] }] },
                            { type: "box", layout: "vertical", position: "absolute", offsetTop: toPx(data.identity.nameTop), offsetStart: "0px", offsetEnd: "0px", contents: [{ type: "text", text: data.identity.name, weight: data.identity.nameWeight, size: "xxl", color: data.identity.nameColor, align: "center" }] },
                            { type: "box", layout: "vertical", position: "absolute", offsetTop: toPx(data.identity.label1Top), offsetStart: "40px", offsetEnd: "40px", backgroundColor: data.identity.label1Bg, cornerRadius: "md", paddingAll: "4px", contents: [{ type: "text", text: data.identity.label1, size: "xs", color: data.identity.label1Color, align: "center", weight: data.identity.label1Weight }] }
                        ]
                    },
                    footer: { type: "box", layout: "vertical", paddingAll: "15px", backgroundColor: data.footer.footerBg, contents: [{ type: "box", layout: "vertical", backgroundColor: data.footer.themeColor, paddingAll: "12px", cornerRadius: "md", action: { type: "uri", uri: data.footer.uri || "https://line.me" }, contents: [{ type: "text", text: data.footer.label, color: data.footer.textColor, align: "center", weight: data.footer.weight, size: "sm" }] }] }
                };

                if (data.social.show) {
                    bubble.body.contents.push({ type: "box", layout: "horizontal", position: "absolute", offsetTop: toPx(data.social.top), offsetStart: "0px", offsetEnd: "0px", justifyContent: "center", spacing: "md", contents: data.social.icons.map(icon => ({ type: "box", layout: "vertical", width: "32px", height: "32px", cornerRadius: "100px", backgroundColor: "rgba(255,255,255,0.1)", paddingAll: "7px", action: { type: "uri", uri: icon.uri || "https://line.me" }, contents: [{ type: "image", url: SOCIAL_DATA[icon.type]?.url, size: "full" }] })) });
                }

                bubble.body.contents.push({ type: "box", layout: "vertical", position: "absolute", offsetTop: toPx(data.identity.descTop), offsetStart: "30px", offsetEnd: "30px", contents: [{ type: "text", text: data.identity.desc, wrap: true, size: "sm", color: data.identity.descColor, align: data.identity.descAlign, lineHeight: "1.6", weight: data.identity.descWeight }] });
                return bubble;
            }, [data]);

            useEffect(() => { window.parent.postMessage({ type: 'CHILD_READY' }, '*'); }, []);
            useEffect(() => {
                const jsonStr = JSON.stringify(buildJson());
                window.parent.postMessage({ type: 'SYNC_FLEX_DATA', json: jsonStr }, '*');
            }, [data, buildJson]);

            const updateField = (path, val) => {
                const keys = path.split('.');
                setData(prev => {
                    const next = JSON.parse(JSON.stringify(prev));
                    let curr = next;
                    for (let i = 0; i < keys.length - 1; i++) curr = curr[keys[i]];
                    curr[keys[keys.length - 1]] = val;
                    return next;
                });
            };

            const handleMasterMove = (newVal) => {
                const diff = newVal - data.identity.avatarTop;
                setData(prev => ({
                    ...prev,
                    identity: { ...prev.identity, avatarTop: newVal, nameTop: prev.identity.nameTop + diff, label1Top: prev.identity.label1Top + diff, descTop: prev.identity.descTop + diff },
                    social: { ...prev.social, top: prev.social.top + diff }
                }));
            };

            return (
                <div className="flex h-screen bg-slate-100 overflow-hidden font-bold text-black">
                    <div className="w-1/2 bg-white border-r flex flex-col shadow-2xl z-20">
                        <div className="p-6 border-b"><h1 className="text-xl font-black">業務版編輯器 (格式修正)</h1></div>
                        <div className="flex-1 overflow-y-auto p-6 space-y-6 custom-scrollbar text-black">
                            <div className="control-panel space-y-4">
                                <h3 className="text-sm text-slate-400">1. 背景連動調整 (Master)</h3>
                                <div className="flex items-center gap-4"><input type="range" min="0" max="600" value={data.identity.avatarTop} onChange={e=>handleMasterMove(parseInt(e.target.value))} className="flex-1" /><span>{data.identity.avatarTop}</span></div>
                            </div>
                            <div className="control-panel space-y-4">
                                <h3 className="text-sm text-slate-400">2. 文字編輯 (預設黑色)</h3>
                                <input type="text" value={data.identity.name} onChange={e=>updateField('identity.name', e.target.value)} className="w-full p-2 border rounded" placeholder="姓名" />
                                <div className="flex gap-2">
                                    <input type="color" value={data.identity.nameColor} onChange={e=>updateField('identity.nameColor', e.target.value)} className="w-10 h-10" />
                                    <select value={data.identity.nameWeight} onChange={e=>updateField('identity.nameWeight', e.target.value)} className="flex-1 border rounded"><option value="bold">粗體</option><option value="regular">一般</option></select>
                                </div>
                                <textarea value={data.identity.desc} onChange={e=>updateField('identity.desc', e.target.value)} className="w-full p-2 border rounded h-20" placeholder="說明"></textarea>
                                <div className="flex bg-slate-100 p-1 rounded gap-1">
                                    {['start', 'center', 'end'].map(a => <button key={a} onClick={()=>updateField('identity.descAlign', a)} className={`flex-1 text-xs py-1 rounded ${data.identity.descAlign === a ? 'bg-white shadow' : ''}`}>{a}</button>)}
                                </div>
                            </div>
                            <div className="control-panel space-y-4">
                                <h3 className="text-sm text-slate-400">3. 社群連結 (含 TikTok)</h3>
                                {data.social.icons.map((s, i) => (
                                    <div key={i} className="flex gap-2">
                                        <select value={s.type} onChange={e=>{const nl=[...data.social.icons]; nl[i].type=e.target.value; updateField('social.icons', nl)}} className="border rounded text-xs w-24">
                                            {Object.keys(SOCIAL_DATA).map(k=><option key={k} value={k}>{SOCIAL_DATA[k].label}</option>)}
                                        </select>
                                        <input type="text" value={s.uri} onChange={e=>{const nl=[...data.social.icons]; nl[i].uri=e.target.value; updateField('social.icons', nl)}} className="flex-1 p-1 border rounded text-xs" />
                                    </div>
                                ))}
                            </div>
                            <div className="control-panel space-y-4 mb-10">
                                <h3 className="text-sm text-slate-400">4. 底部 Footer</h3>
                                <div className="grid grid-cols-2 gap-2">
                                    <div className="flex flex-col"><label className="text-[10px]">Footer 背景</label><input type="color" value={data.footer.footerBg} onChange={e=>updateField('footer.footerBg', e.target.value)} className="w-full h-8" /></div>
                                    <div className="flex flex-col"><label className="text-[10px]">按鈕背景</label><input type="color" value={data.footer.themeColor} onChange={e=>updateField('footer.themeColor', e.target.value)} className="w-full h-8" /></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div className="flex-1 flex flex-col chat-room-bg overflow-y-auto">
                        <div className="p-10 flex justify-center">
                            <div className="rounded-3xl shadow-2xl overflow-hidden relative" style={{ width: '300px', backgroundColor: data.footer.footerBg }}>
                                <div className="relative" style={{ height: '600px' }}>
                                    <img src={data.media.url} className="w-full h-full object-cover" />
                                    <div className="absolute w-full flex justify-center" style={{ top: toPx(data.identity.avatarTop) }}><img src={data.identity.avatar} className="w-20 h-20 rounded-full border-4 border-white shadow-xl" /></div>
                                    <div className="absolute w-full text-center px-4" style={{ top: toPx(data.identity.nameTop), color: data.identity.nameColor, fontWeight: data.identity.nameWeight==='bold'?900:400, fontSize: '20px' }}>{data.identity.name}</div>
                                    <div className="absolute w-full px-8" style={{ top: toPx(data.identity.descTop), color: data.identity.descColor, textAlign: data.identity.descAlign==='start'?'left':data.identity.descAlign==='end'?'right':'center', fontSize: '12px' }}>{data.identity.desc}</div>
                                </div>
                                <div className="p-4" style={{ backgroundColor: data.footer.footerBg }}><div className="py-3 text-center rounded-xl text-sm" style={{ backgroundColor: data.footer.themeColor, color: data.footer.textColor }}>{data.footer.label}</div></div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
